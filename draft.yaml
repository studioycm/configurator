models:
  CatalogGroup:
    name: string
    slug: string unique
    description: text nullable
    parent_id: id foreign:catalog_groups nullable
    is_active: boolean default:true
    sort_order: integer nullable
    path: string nullable
    relationships:
      hasMany: ProductProfile, FileAttachment

  ProductProfile:
    catalog_group_id: id foreign:catalog_groups
    name: string
    product_code: string index
    slug: string unique nullable
    short_label: string nullable
    is_active: boolean default:true
    sort_order: integer nullable
    relationships:
      belongsTo: CatalogGroup
      hasMany: ProductConfiguration, ConfigProfile, FileAttachment

  ProductConfiguration:
    product_profile_id: id foreign:product_profiles
    configuration_code: string index
    name: string nullable
    is_active: boolean default:true
    drawing_image_path: string nullable
    config_data: json nullable
    relationships:
      belongsTo: ProductProfile
      hasMany: ConfigurationPart, ConfigurationSpecification, FileAttachment

  ConfigProfile:
    product_profile_id: id foreign:product_profiles
    name: string
    slug: string unique
    description: text nullable
    scope: string nullable           # cast later to ConfigProfileScope
    is_active: boolean default:true
    extra_rules_json: json nullable  # advanced JSON rules payload
    relationships:
      belongsTo: ProductProfile
      hasMany: ConfigAttribute, OptionRule

  ConfigAttribute:
    config_profile_id: id foreign:config_profiles
    name: string
    label: string nullable
    slug: string nullable
    input_type: string default:toggle
    sort_order: integer index
    is_required: boolean default:true
    segment_index: integer nullable
    relationships:
      belongsTo: ConfigProfile
      hasMany: ConfigOption

  ConfigOption:
    config_attribute_id: id foreign:config_attributes
    label: string
    code: string:4 index             # 2â€“4 char segment, indexed
    sort_order: integer nullable
    is_default: boolean default:false
    is_active: boolean default:true
    relationships:
      belongsTo: ConfigAttribute
      hasMany: OptionRule

  OptionRule:
    config_profile_id: id foreign:config_profiles
    config_option_id: id foreign:config_options
    target_attribute_id: id foreign:config_attributes
    allowed_option_ids: json nullable
    relationships:
      belongsTo: ConfigProfile, ConfigOption

  FileAttachment:
    catalog_group_id: id foreign:catalog_groups nullable
    product_profile_id: id foreign:product_profiles nullable
    product_configuration_id: id foreign:product_configurations nullable
    title: string
    file_path: string
    file_type: string nullable        # cast to enum later
    mime_type: string nullable
    sort_order: integer nullable
    is_primary: boolean default:false
    relationships:
      belongsTo: CatalogGroup, ProductProfile, ProductConfiguration

  Part:
    name: string
    code: string nullable
    description: text nullable
    default_material: string nullable
    is_active: boolean default:true
    relationships:
      hasMany: ConfigurationPart

  ConfigurationPart:
    product_configuration_id: id foreign:product_configurations
    part_id: id foreign:parts nullable
    part_number: integer              # drawing part number (1..n)
    label: string nullable
    material: string nullable
    quantity: decimal:8,3 nullable
    unit: string nullable
    segment_index: integer nullable   # which code segment affects this part
    notes: text nullable
    sort_order: integer nullable
    relationships:
      belongsTo: ProductConfiguration, Part

  ConfigurationSpecification:
    product_configuration_id: id foreign:product_configurations
    spec_group: string nullable       # 'Dimensions', 'Specifications', etc.
    key: string                       # 'A', 'Working Pressure', ...
    value: string                     # '287 mm', '25 bar (360 psi)', ...
    unit: string nullable             # 'mm', 'bar', etc.
    sort_order: integer nullable
    relationships:
      belongsTo: ProductConfiguration
